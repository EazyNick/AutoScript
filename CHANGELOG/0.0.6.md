## [0.0.6] - 2025-12-28

### 추가된 기능

#### Undo 기능 (노드 이동)
- 노드 드래그 후 Ctrl+Z로 이전 위치로 되돌리기 기능 구현
- 스크립트별 독립적인 Undo 스택 관리
- 노드 이동 시 자동으로 스냅샷 저장 및 DB 동기화

#### Undo 기능 확장 (노드 삭제) - 2026-01-05
- 노드 삭제 후 Ctrl+Z로 삭제된 노드 복원 기능 추가
- 삭제된 노드의 연결 정보까지 완전히 복원
- 최대 20개 작업 기록까지 Undo 가능 (이동/삭제 공통)

#### 키보드 단축키
- **Ctrl+N**: 현재 포커스한 스크립트에서 노드 추가 모달 열기
  - 스크립트가 선택되어 있을 때만 동작
  - 스크립트가 선택되지 않은 경우 경고 로그 출력

### 성능 최적화

#### 시작 노드 로딩 개선 - 2026-01-05
- 경계 노드(시작/종료)만 먼저 로드하고 나머지는 지연 로드
- 최초 실행 시 시작 노드 표시 속도 대폭 개선 (약 5초 → 즉시)

### 코드 개선

#### Python 서버 코드 모듈화 - 2026-01-05
- `server/api/helpers/` 폴더 생성 및 헬퍼 함수 분리
  - `script_helpers.py`: 스크립트 조회/저장 헬퍼
  - `response_helpers.py`: 응답 생성 헬퍼
  - `router_wrapper.py`: 라우터 래퍼
  - `constants.py`: API 상수 정의
- 하드코딩된 값들을 상수로 변경 (HTTP 상태 코드, 에러 메시지, 제한값 등)
- 중복 코드 제거 및 공통 로직 통합

#### JavaScript 프론트엔드 코드 모듈화 - 2026-01-05
- `UI/src/pages/workflow/constants/` 폴더에 상수 파일 생성
  - `timing-constants.js`: 타이밍 관련 상수 (지연 시간, 간격 등)
  - `size-constants.js`: 크기 및 거리 상수 (캔버스 크기, 임계값 등)
  - `style-constants.js`: 스타일 상수 (opacity, z-index, padding 등)
  - `undo-redo-constants.js`: Undo/Redo 관련 상수
- 하드코딩된 숫자 값들을 상수로 변경
- 유지보수성 향상: 수치 변경 시 상수 파일만 수정하면 됨

### 주요 변경사항
- **이전 노드 출력 접근 경로 형식 변경**: `output.data.execution_id` → `outdata.output.execution_id`
  - 노드 실행 결과는 기존 형식 `{action, status, output}` 유지
  - 다음 노드에서 이전 노드 결과를 참조할 때만 `outdata.`/`indata.` 경로 사용
  - `outdata.output.execution_id`: 이전 노드의 출력 데이터 접근
  - `indata.parameter_name`: 이전 노드의 입력 파라미터 접근 (향후 지원)
- **메타데이터 자동 추가**: 노드 실행 결과에 메타데이터 필드 자동 포함
  - `_execution_id`: 워크플로우 실행 ID
  - `_script_id`: 스크립트 ID
  - `_node_id`: 노드 ID
  - `_node_name`: 노드 이름
- **범용 필드 경로 해석 시스템**: 모든 노드에서 이전 노드 출력 값을 자동으로 해석하는 유틸리티 추가
  - `server/utils/field_path_resolver.py`: `outdata.`/`indata.` 경로 해석 유틸리티
  - 엑셀 노드뿐만 아니라 모든 노드에서 경로 문자열 자동 해석
  - 새로운 노드 추가 시 코드 수정 불필요

### 기능 개선
- **output_override 동작 변경**: `output_override`가 설정되어 있어도 실제 노드를 항상 실행
  - UI 미리보기용으로만 사용되며, 실제 실행을 건너뛰지 않음
  - 파일 열기, API 호출 등 부수 효과가 항상 정상 동작
- **엑셀 시트 선택 노드 추가**: 엑셀 열기 노드 이후 특정 시트를 선택하는 노드 추가
  - 시트 이름 또는 시트 인덱스로 선택 가능
  - `execution_id`를 통해 엑셀 객체 자동 연결
- **엑셀 노드 간 execution_id 연결 개선**: 엑셀 열기 노드와 엑셀 시트 선택 노드 간 execution_id 불일치 문제 해결
  - 엑셀 열기 노드의 출력 execution_id를 저장 키로 사용하도록 수정
  - 엑셀 시트 선택 노드에서 execution_id를 찾지 못할 때 메타데이터의 _execution_id도 시도
- **엑셀 객체 생명주기 관리 개선**: 엑셀 객체가 API 호출 완료 시마다 정리되는 문제 해결
  - 엑셀 닫기 노드가 실행된 경우에만 엑셀 객체를 정리하도록 수정
  - 각 노드가 별도의 API 호출로 실행되므로, 엑셀 객체를 즉시 정리하지 않도록 변경
- **엑셀 닫기 노드 성능 개선**: 엑셀 닫기 노드의 무한 로딩 문제 해결
  - Excel 종료 대기 로직 제거 (excel_app.Quit() 호출 후 바로 반환)

### 기술적 변경사항

- `UndoRedoService` 클래스 추가
- DB 스키마 기반 노드 정보 스냅샷 저장
- 노드 드래그 시작/종료 시 자동 스냅샷 생성
- 노드 삭제 스냅샷 저장 및 복원 로직 추가 (2026-01-05)
- `NodeRegistry`: 경계 노드 우선 로드 메서드 추가 (`loadBoundaryNodeScripts`) (2026-01-05)
- `WorkflowPage`: 노드 스크립트 지연 로딩 구현 (2026-01-05)
- Python API 헬퍼 함수 통합으로 코드 중복 제거 (2026-01-05)
- 상수 파일을 통한 중앙 집중식 설정 관리 (2026-01-05)
- 키보드 단축키 처리 로직 개선 (스크립트 선택 상태 확인)

### 개발자 경험 개선
- **자동 경로 해석**: 파라미터 값이 `outdata.` 또는 `indata.`로 시작하면 자동으로 실제 값으로 변환
  - 하드코딩된 노드 타입 목록 제거
  - 확장 가능한 범용 시스템으로 개선
- **엑셀 노드 검증 동적화**: 엑셀 관련 노드 검증이 하드코딩된 배열 대신 `nodes_config.py`에서 동적으로 가져오도록 변경
  - 새로운 엑셀 노드 추가 시 자동으로 검증 대상에 포함
  - `excel-`로 시작하는 모든 노드 타입을 자동 감지 (단, `excel-open` 제외)
- **경계 노드 시스템 개선**: `start` 노드 하드코딩을 경계 노드(boundary node) 카테고리 기반으로 변경
  - `isBoundaryNodeSync()` 함수 추가로 동기적 경계 노드 체크 지원
  - 모든 경계 노드가 자동으로 인식되며, 새로운 경계 노드 추가 시 코드 수정 불필요
  - 워크플로우 실행 시 경계 노드를 동적으로 찾아 시작점으로 사용
- **노드 연결 정보 저장**: 노드 저장 시 연결 상태와 순서 정보를 DB에 저장
  - `nodes` 테이블에 `is_connected`, `connection_sequence`, `node_identifier` 컬럼 추가
  - 스크립트 저장 시 각 노드의 연결 여부, 연결 순서, 노드 식별자 자동 계산 및 저장
  - 노드 로드 시 연결 정보 함께 조회
- **로그 시스템 개선**: 노드 실행 로그에 연결 정보 추가
  - `node_execution_logs` 테이블에 연결 정보 컬럼 추가
  - 로그에 노드 연결 여부, 연결 순서, 노드 식별자 포함
  - 오류 발생 시 로그 저장 확인 로직 개선 (대기 시간 및 상태 확인 로직 개선)
- **로그 모듈 구조 리팩토링**: 노드 실행 로그 관련 모듈 통합 및 구조 개선
  - `server/execution_logging/` 폴더로 관련 모듈 통합
  - `LogClient` → `ExecutionLogClient`로 클래스명 변경
  - `server/utils/log_client.py` → `server/execution_logging/execution_log_client.py`
  - `server/models/log_models.py` → `server/execution_logging/execution_log_models.py`
  - `server/db/node_execution_log_repository.py` → `server/execution_logging/execution_log_repository.py`
  - Python 표준 라이브러리 `logging` 모듈과의 이름 충돌 방지를 위해 폴더명을 `execution_logging`으로 변경

### 이전 노드 출력 접근 방법 변경

**이전 (v0.0.5 이하):**
- 경로 형식: `output.data.execution_id`, `output.execution_id`
- 노드 실행 결과: `{action, status, output}`

**현재 (v0.0.6 이후):**
- 경로 형식: `outdata.output.execution_id` (이전 노드의 출력 데이터)
- 경로 형식: `indata.parameter_name` (이전 노드의 입력 파라미터, 향후 지원)
- 노드 실행 결과: `{action, status, output, _execution_id, _script_id, _node_id, _node_name}` (기존 형식 + 메타데이터)

**중요:** 
- 노드 실행 결과는 기존 형식 `{action, status, output}`을 유지하며, 메타데이터 필드가 자동으로 추가됩니다.
- 다음 노드에서 이전 노드 결과를 참조할 때만 `outdata.`/`indata.` 경로를 사용합니다.

